AWSTemplateFormatVersion:  2010-09-09
Description:  Template for Ec2 Incstances.
Parameters:
  AvailabilityZoneOption:
    Type: CommaDelimitedList
    Default:  ap-northeast-1c, ap-northeast-1a, ap-northeast-1d
  ImageIdOption:
    Type:  CommaDelimitedList
    Default:  AmazonLInux2, CentOs7, RHEL  # later describe AMI-id
  InstanceTypeOption:
    Type: CommaDelimitedList
    Default:  t3.micro, m5.2xlarge, m5.xlarge, m5.large, r5.2xlarge, r5.xlarge, r5.large
  TagKey:
    Type:  String
    Default:  Name
  TagValue:
    Type:  String
    Default:  my
  OutputPrefix:
    Type:  String
    Default:  my
Resources:
# EC201 -- Web Server#1
  EC201:
    Type:  AWS::EC2::Instance
    Properties:
      AvailabilityZone:  !Select  [  0, !Ref  AvailabilityZoneOption  ]
      BlockDeviceMappings:
        - DeviceName:  /dev/sda1
          Ebs:
            VolumeSize:  50
            VolumeType:  io1
            DeleteOnTermination: true
        - DeviceName:  /dev/sdd
          Ebs:
            VolumeSize:  50
            VolumeType:  io1
            DeleteOnTermination: true            
      DisableApiTermination:  false
      # IamInstanceProfile:  !Ref
      ImageId:  !Select  [  0,  !Ref  ImageIdOption  ]
      InstanceType:  !Select  [  0,  !Ref  InstanceTypeOption  ]
      # KeyName:  !Ref  
      PropagateTagsToVolumeOnCreation:  true
      SecurityGroupIds:
        - !ImportValue  my-Ec2WebSg01
      SubnetId:  !ImportValue  my-Subnet03
      Tags:
        - Key:  !Ref  TagKey
          Value:  !Sub  ${TagValue}-ec2-web-c-01
# EC203 -- Web Server#2
# EC203 -- App Server#1
# EC204 -- App Server#2


Outputs:
